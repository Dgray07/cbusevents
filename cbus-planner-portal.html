<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>CBusEvents â€” Planner Portal</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --bg:#0b0b0f;--surface:#13131a;--card:#1a1a24;--border:#25252f;
  --text:#e8e8f0;--sub:#8888a0;--muted:#55556a;
  --orange:#FF6B35;--green:#22c55e;--blue:#60a5fa;--gold:#f59e0b;
}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;min-height:100vh;}
a{text-decoration:none;color:inherit;}
button{cursor:pointer;font-family:'DM Sans',sans-serif;border:none;}
input,textarea,select{font-family:'DM Sans',sans-serif;}
@keyframes spin{to{transform:rotate(360deg);}}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px);}to{opacity:1;transform:translateY(0);}}

/* NAV */
nav{position:sticky;top:0;z-index:100;background:rgba(11,11,15,0.95);backdrop-filter:blur(16px);border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;padding:0 40px;height:60px;}
.nav-logo{font-family:'Syne',sans-serif;font-weight:800;font-size:18px;cursor:pointer;}
.nav-logo span{color:var(--orange);}
.nav-logo-sub{font-size:10px;color:var(--muted);font-weight:400;margin-left:6px;letter-spacing:1px;text-transform:uppercase;}
.nav-links{display:flex;gap:4px;}
.nav-btn{background:none;border:none;color:var(--sub);font-size:13px;padding:7px 14px;border-radius:8px;font-weight:500;transition:all 0.15s;}
.nav-btn:hover,.nav-btn.active{background:var(--card);color:var(--text);}
.nav-right{display:flex;align-items:center;gap:10px;}
.nav-user{font-size:13px;color:var(--sub);}
.nav-cta{background:var(--orange);color:#fff;padding:8px 18px;border-radius:8px;font-size:13px;font-weight:700;transition:opacity 0.15s;}
.nav-cta:hover{opacity:0.85;}
.nav-outline{background:transparent;color:var(--text);border:1.5px solid var(--border);padding:7px 16px;border-radius:8px;font-size:13px;font-weight:500;transition:all 0.15s;}
.nav-outline:hover{border-color:var(--muted);}

/* HERO */
.planner-hero{background:linear-gradient(135deg,#130800 0%,#1a1000 40%,#0b0b0f 100%);border-bottom:1px solid var(--border);padding:56px 40px;text-align:center;}
.planner-hero h1{font-family:'Syne',sans-serif;font-size:clamp(28px,4vw,48px);font-weight:800;margin-bottom:12px;}
.planner-hero h1 span{color:var(--orange);}
.planner-hero p{color:var(--sub);font-size:16px;max-width:500px;margin:0 auto 28px;line-height:1.65;}
.hero-btns{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;}

/* LAYOUT */
.page{padding:36px 40px;animation:fadeUp 0.3s ease;max-width:1100px;margin:0 auto;}
.section-title{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;margin-bottom:6px;}
.section-sub{color:var(--sub);font-size:13px;margin-bottom:24px;}

/* STAT CARDS */
.stat-row{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-bottom:28px;}
.stat-card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px 20px;}
.stat-num{font-family:'Syne',sans-serif;font-size:26px;font-weight:800;margin-bottom:3px;}
.stat-label{font-size:12px;color:var(--sub);}

/* CARDS */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;margin-bottom:16px;}
.card-header{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;border-bottom:1px solid var(--border);}
.card-title{font-family:'Syne',sans-serif;font-size:15px;font-weight:700;}
.card-body{padding:20px;}

/* VENUE GRID */
.venue-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px;}
.venue-card{background:var(--card);border:1px solid var(--border);border-radius:14px;overflow:hidden;cursor:pointer;transition:all 0.2s;}
.venue-card:hover{border-color:var(--orange);transform:translateY(-2px);}
.venue-card-img{width:100%;height:150px;object-fit:cover;background:var(--surface);display:flex;align-items:center;justify-content:center;font-size:36px;}
.venue-card-img img{width:100%;height:100%;object-fit:cover;}
.venue-card-body{padding:14px 16px;}
.venue-card-type{font-size:11px;color:var(--orange);font-weight:600;text-transform:uppercase;letter-spacing:0.5px;margin-bottom:4px;}
.venue-card-name{font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:6px;}
.venue-card-desc{color:var(--sub);font-size:12px;line-height:1.5;margin-bottom:10px;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.venue-card-footer{display:flex;justify-content:space-between;align-items:center;}
.venue-card-loc{font-size:11px;color:var(--muted);}

/* INQUIRY ITEMS */
.inquiry-item{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px 18px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;gap:16px;cursor:pointer;transition:border-color 0.2s;}
.inquiry-item:hover{border-color:var(--muted);}
.inq-venue{font-weight:600;font-size:14px;margin-bottom:3px;}
.inq-meta{font-size:12px;color:var(--sub);}

/* EVENT ITEMS */
.event-item{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:16px 18px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;gap:16px;}
.event-title{font-weight:600;font-size:14px;margin-bottom:3px;}
.event-meta{font-size:12px;color:var(--sub);}

/* BADGES */
.badge{display:inline-flex;align-items:center;border-radius:20px;padding:3px 10px;font-size:11px;font-weight:700;}
.badge-green{background:#22c55e20;color:var(--green);border:1px solid #22c55e30;}
.badge-orange{background:#FF6B3520;color:var(--orange);border:1px solid #FF6B3530;}
.badge-blue{background:#60a5fa20;color:var(--blue);border:1px solid #60a5fa30;}
.badge-muted{background:var(--surface);color:var(--muted);border:1px solid var(--border);}

/* BUTTONS */
.btn{border:none;border-radius:8px;padding:9px 18px;font-size:13px;font-weight:600;cursor:pointer;transition:all 0.15s;font-family:'DM Sans',sans-serif;}
.btn-primary{background:var(--orange);color:#fff;}
.btn-primary:hover{opacity:0.85;}
.btn-outline{background:transparent;border:1.5px solid var(--border);color:var(--text);}
.btn-outline:hover{border-color:var(--muted);}
.btn-ghost{background:var(--surface);color:var(--sub);border:1px solid var(--border);}
.btn-ghost:hover{color:var(--text);}
.btn-sm{padding:5px 12px;font-size:12px;}

/* FORM */
.field{margin-bottom:14px;}
.field label{display:block;font-size:12px;color:var(--sub);font-weight:500;margin-bottom:5px;}
.field input,.field select,.field textarea{width:100%;background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:10px 13px;color:var(--text);font-size:14px;outline:none;transition:border-color 0.2s;}
.field input:focus,.field select:focus,.field textarea:focus{border-color:var(--orange);}
.field textarea{min-height:90px;resize:vertical;}
.field-row{display:grid;grid-template-columns:1fr 1fr;gap:12px;}

/* SEARCH */
.search-bar{display:flex;gap:10px;margin-bottom:20px;}
.search-wrap{flex:1;position:relative;}
.search-icon{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:var(--muted);}
.search-input{width:100%;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:11px 14px 11px 38px;color:var(--text);font-size:14px;outline:none;transition:border-color 0.2s;}
.search-input:focus{border-color:var(--orange);}
.filter-select{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:11px 14px;color:var(--text);font-size:13px;outline:none;min-width:140px;}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.85);z-index:200;display:flex;align-items:flex-start;justify-content:center;padding:40px 20px;overflow-y:auto;}
.modal{background:var(--card);border:1px solid var(--border);border-radius:16px;width:100%;max-width:580px;animation:fadeUp 0.3s ease;}
.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid var(--border);}
.modal-title{font-family:'Syne',sans-serif;font-size:17px;font-weight:700;}
.modal-body{padding:24px;}
.modal-footer{padding:16px 24px;border-top:1px solid var(--border);display:flex;justify-content:flex-end;gap:8px;}

/* AUTH */
.auth-wrap{min-height:calc(100vh - 60px);display:flex;align-items:center;justify-content:center;padding:40px 20px;}
.auth-card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:40px;width:100%;max-width:420px;}
.auth-logo{font-family:'Syne',sans-serif;font-size:20px;font-weight:800;margin-bottom:4px;}
.auth-logo span{color:var(--orange);}
.auth-tabs{display:flex;gap:4px;background:var(--surface);border-radius:10px;padding:4px;margin-bottom:24px;}
.auth-tab{flex:1;padding:8px;border-radius:7px;font-size:13px;font-weight:600;color:var(--sub);background:none;border:none;cursor:pointer;transition:all 0.15s;}
.auth-tab.active{background:var(--card);color:var(--text);}

/* EMPTY */
.empty{text-align:center;padding:48px 20px;color:var(--sub);}
.empty-icon{font-size:40px;margin-bottom:12px;}
.empty h3{font-family:'Syne',sans-serif;font-size:17px;font-weight:700;margin-bottom:6px;color:var(--text);}

/* TOAST */
.toast{position:fixed;bottom:24px;right:24px;z-index:999;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:12px 18px;font-size:13px;font-weight:500;animation:fadeUp 0.3s ease;box-shadow:0 8px 32px rgba(0,0,0,0.4);display:none;}
.toast.success{border-color:#22c55e40;color:var(--green);}
.toast.error{border-color:#ef444440;color:#ef4444;}

@media(max-width:700px){
  nav{padding:0 16px;}
  .page{padding:24px 16px;}
  .planner-hero{padding:36px 16px;}
  .stat-row{grid-template-columns:1fr 1fr;}
  .venue-grid{grid-template-columns:1fr;}
  .field-row{grid-template-columns:1fr;}
}
</style>
</head>
<body>

<nav id="topNav">
  <div class="nav-logo" onclick="currentUser?nav('dashboard'):showAuth('login')">
    CBUS<span>EVENTS</span>
    <span class="nav-logo-sub">Planner</span>
  </div>
  <div class="nav-links" id="navLinks" style="display:none">
    <button class="nav-btn" id="nav-dashboard" onclick="nav('dashboard')">Dashboard</button>
    <button class="nav-btn" id="nav-venues" onclick="nav('venues')">Find Venues</button>
    <button class="nav-btn" id="nav-inquiries" onclick="nav('inquiries')">My Inquiries</button>
    <button class="nav-btn" id="nav-events" onclick="nav('events')">My Events</button>
  </div>
  <div class="nav-right" id="navRight">
    <button class="nav-outline" onclick="showAuth('login')">Sign In</button>
    <button class="nav-cta" onclick="showAuth('signup')">Get Started Free â†’</button>
  </div>
</nav>

<div id="app"></div>
<div id="modal"></div>
<div id="toast" class="toast"></div>

<script src="https://unpkg.com/@supabase/supabase-js@2/dist/umd/supabase.js"></script>
<script>
const SB_URL="https://toblgvatvsjljbqogzsv.supabase.co";
const SB_KEY="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRvYmxndmF0dnNqbGpicW9nenN2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzIxMDgwNTAsImV4cCI6MjA4NzY4NDA1MH0._WJEQPizNDiQfDXQB_DHPaQhixPGpMdmYQSmyWmm_FQ";
const sb=supabase.createClient(SB_URL,SB_KEY);

const VENUE_IMGS={
  'Sacred Palm':'https://images.unsplash.com/photo-1470337458703-46ad1756a187?w=600&q=80',
  "Dick's Den":'https://images.unsplash.com/photo-1415201364774-f6f0bb35f28f?w=600&q=80',
  'Lincoln Social Rooftop':'https://images.unsplash.com/photo-1519671482749-fd09be7ccebf?w=600&q=80',
  'Half Baked':'https://images.unsplash.com/photo-1559526324-593bc073d938?w=600&q=80',
  'Columbus Funny Bone':'https://images.unsplash.com/photo-1580809361436-42a7ec204889?w=600&q=80',
  "Bossy Grrl's Pin Up Joint":'https://images.unsplash.com/photo-1516450360452-9312f5e86fc7?w=600&q=80',
  'The Nest Theatre':'https://images.unsplash.com/photo-1598387181032-a3103a2db5b3?w=600&q=80',
  'Park Street Tavern':'https://images.unsplash.com/photo-1572116469696-31de0f17cc34?w=600&q=80',
  'Fifteen32 Social':'https://images.unsplash.com/photo-1543007630-9710e4a00a20?w=600&q=80',
  'Club 185':'https://images.unsplash.com/photo-1514362545857-3bc16c4c7d1b?w=600&q=80',
};

let currentUser=null,currentPage='home';
let allVenues=[],myInquiries=[],myEvents=[];

// â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function toast(msg,type='success'){
  const el=document.getElementById('toast');
  el.textContent=msg;el.className=`toast ${type}`;el.style.display='block';
  setTimeout(()=>el.style.display='none',3000);
}
function fmt(dt){return new Date(dt).toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'});}
function fmtTime(dt){return new Date(dt).toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'});}
function venueEmoji(type){
  if(!type)return'ğŸ›';const t=type.toLowerCase();
  if(t.includes('comedy')||t.includes('improv'))return'ğŸ¤';
  if(t.includes('speakeasy')||t.includes('cocktail'))return'ğŸ¥ƒ';
  if(t.includes('rooftop'))return'ğŸŒ†';
  if(t.includes('brewery'))return'ğŸº';
  if(t.includes('theatre')||t.includes('theater')||t.includes('performance'))return'ğŸ­';
  return'ğŸ¸';
}
function getImg(v){return VENUE_IMGS[v.name]||v.cover_image_url||null;}
function closeModal(){document.getElementById('modal').innerHTML='';}

// â”€â”€ AUTH â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function init(){
  document.getElementById('app').innerHTML=`<div style="min-height:60vh;display:flex;align-items:center;justify-content:center"><div style="width:32px;height:32px;border:3px solid var(--border);border-top-color:var(--orange);border-radius:50%;animation:spin 0.8s linear infinite"></div></div>`;
  const{data:{session}}=await sb.auth.getSession();
  if(session){
    currentUser=session.user;
    await loadData();
    await handleBoostReturn();
    setLoggedInNav();
    nav('dashboard');
  } else {
    renderHero();
  }
}

function setLoggedInNav(){
  document.getElementById('navLinks').style.display='flex';
  const name=currentUser.user_metadata?.full_name||currentUser.email.split('@')[0];
  document.getElementById('navRight').innerHTML=`
    <span class="nav-user">ğŸ‘‹ ${name}</span>
    <button class="nav-outline" onclick="signOut()">Sign Out</button>
  `;
}

async function signOut(){
  await sb.auth.signOut();
  currentUser=null;
  document.getElementById('navLinks').style.display='none';
  document.getElementById('navRight').innerHTML=`
    <button class="nav-outline" onclick="showAuth('login')">Sign In</button>
    <button class="nav-cta" onclick="showAuth('signup')">Get Started Free â†’</button>
  `;
  renderHero();
}

async function handleBoostReturn(){
  const p=new URLSearchParams(window.location.search);
  const ref=p.get('client_reference_id')||'';
  if(!ref.startsWith('boost_'))return;
  window.history.replaceState({},'',window.location.pathname);
  const parts=ref.split('_'); // boost_EVENTID_TIER
  const eventId=parts[1];
  const tier=parts[2]; // '7' or '30'
  if(!eventId||!tier)return;
  const days=parseInt(tier);
  const until=new Date();
  until.setDate(until.getDate()+days);
  const{error}=await sb.from('events').update({
    promoted_until:until.toISOString(),
    boost_tier:tier
  }).eq('id',eventId);
  if(!error) toast(`âš¡ Event boosted for ${days} days!`);
}

async function loadData(){
  const[vRes,iRes,eRes]=await Promise.all([
    sb.from('venues').select('*').eq('status','approved').order('tier',{ascending:false}),
    sb.from('inquiries').select('*,venues(name,venue_type,neighborhood)').eq('email',currentUser.email).order('created_at',{ascending:false}),
    sb.from('events').select('*,venues(name)').eq('status','published').gte('start_time',new Date().toISOString()).order('start_time',{ascending:true}),
  ]);
  allVenues=vRes.data||[];
  myInquiries=iRes.data||[];
  // Filter events "added by this planner" â€” using a planner_email field if exists
  myEvents=eRes.data?.filter(e=>e.planner_email===currentUser.email)||[];
}

// â”€â”€ HERO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderHero(){
  document.getElementById('app').innerHTML=`
    <div class="planner-hero">
      <div style="display:inline-flex;align-items:center;gap:6px;background:var(--orange);color:#fff;border-radius:20px;padding:4px 14px;font-size:11px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:16px">ğŸ¯ For Event Planners</div>
      <h1>Plan your next Columbus<br>event the <span>right way</span></h1>
      <p>Browse venues, send booking inquiries, track your requests, and list your events â€” all in one free dashboard.</p>
      <div class="hero-btns">
        <button class="btn btn-primary" style="padding:13px 28px;font-size:15px" onclick="showAuth('signup')">Create Free Account â†’</button>
        <button class="btn btn-outline" style="padding:13px 24px;font-size:15px" onclick="showAuth('login')">Sign In</button>
      </div>
    </div>

    <div style="padding:52px 40px;max-width:1100px;margin:0 auto">
      <div style="text-align:center;margin-bottom:40px">
        <div class="section-title" style="font-size:24px">Everything a Columbus planner needs</div>
        <div class="section-sub" style="font-size:15px">Free forever for event planners</div>
      </div>
      <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;margin-bottom:52px">
        ${[
          {icon:'ğŸ›',title:'Browse Venues',desc:'Filter by type, neighborhood, and capacity. Find the perfect space for any event.'},
          {icon:'ğŸ“¬',title:'Send Inquiries',desc:'Contact venues directly from your dashboard. Track every request in one place.'},
          {icon:'ğŸ“‹',title:'Track Requests',desc:'See the status of all your venue inquiries. Never lose track of a conversation.'},
          {icon:'ğŸ“…',title:'List Your Events',desc:'Publish your events to the CBusEvents directory for free. Reach Columbus.'},
        ].map(f=>`
          <div style="background:var(--card);border:1px solid var(--border);border-radius:14px;padding:24px">
            <div style="font-size:28px;margin-bottom:10px">${f.icon}</div>
            <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:6px">${f.title}</div>
            <div style="color:var(--sub);font-size:13px;line-height:1.6">${f.desc}</div>
          </div>`).join('')}
      </div>

      <!-- Preview venues -->
      <div style="margin-bottom:12px;display:flex;justify-content:space-between;align-items:center">
        <div class="section-title">Featured Columbus Venues</div>
        <button class="btn btn-ghost btn-sm" onclick="showAuth('signup')">See All â†’</button>
      </div>
      <div class="venue-grid">
        ${allVenues.slice(0,4).map(v=>venueCardHTML(v,true)).join('')}
      </div>
    </div>
  `;
  // Load venues for preview
  loadVenuesPreview();
}

async function loadVenuesPreview(){
  if(allVenues.length)return;
  const{data}=await sb.from('venues').select('*').eq('status','approved').limit(4);
  allVenues=data||[];
  const el=document.querySelector('.venue-grid');
  if(el)el.innerHTML=allVenues.map(v=>venueCardHTML(v,true)).join('');
}

// â”€â”€ AUTH FORMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showAuth(tab='login'){
  document.getElementById('app').innerHTML=`
    <div class="auth-wrap">
      <div class="auth-card">
        <div class="auth-logo">CBUS<span>EVENTS</span> <span style="font-size:12px;color:var(--muted);font-weight:400">Planner</span></div>
        <div style="color:var(--sub);font-size:13px;margin-bottom:20px">Free for event planners â€” always</div>
        <div class="auth-tabs">
          <button class="auth-tab${tab==='login'?' active':''}" id="tab-login" onclick="switchTab('login')">Sign In</button>
          <button class="auth-tab${tab==='signup'?' active':''}" id="tab-signup" onclick="switchTab('signup')">Create Account</button>
        </div>
        <div id="authForm">${tab==='login'?loginForm():signupForm()}</div>
        <div style="margin-top:16px;text-align:center">
          <button onclick="window.location.href='https://cbusevents.netlify.app'" style="background:none;border:none;color:var(--muted);font-size:12px;cursor:pointer">â† Back to CBusEvents</button>
        </div>
      </div>
    </div>`;
}

function switchTab(tab){
  document.querySelectorAll('.auth-tab').forEach(el=>el.classList.remove('active'));
  document.getElementById('tab-'+tab).classList.add('active');
  document.getElementById('authForm').innerHTML=tab==='login'?loginForm():signupForm();
}

function loginForm(){return`
  <div class="field"><label>Email</label><input id="aEmail" type="email" placeholder="you@email.com" onkeydown="if(event.key==='Enter')doLogin()"></div>
  <div class="field"><label>Password</label><input id="aPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" onkeydown="if(event.key==='Enter')doLogin()"></div>
  <div id="aErr" style="color:#ef4444;font-size:13px;margin-bottom:10px;display:none"></div>
  <button onclick="doLogin()" style="width:100%;background:var(--orange);color:#fff;border:none;border-radius:8px;padding:12px;font-size:14px;font-weight:700;cursor:pointer">Sign In â†’</button>
`;}

function signupForm(){return`
  <div class="field-row">
    <div class="field"><label>First Name</label><input id="aFirst" placeholder="Jane"></div>
    <div class="field"><label>Last Name</label><input id="aLast" placeholder="Smith"></div>
  </div>
  <div class="field"><label>Email</label><input id="aEmail" type="email" placeholder="you@email.com"></div>
  <div class="field"><label>Password</label><input id="aPass" type="password" placeholder="Min 6 characters"></div>
  <div id="aErr" style="color:#ef4444;font-size:13px;margin-bottom:10px;display:none"></div>
  <button onclick="doSignup()" style="width:100%;background:var(--orange);color:#fff;border:none;border-radius:8px;padding:12px;font-size:14px;font-weight:700;cursor:pointer">Create Free Account â†’</button>
  <div style="font-size:12px;color:var(--muted);text-align:center;margin-top:10px">Free forever Â· No credit card needed</div>
`;}

async function doLogin(){
  const email=document.getElementById('aEmail')?.value.trim();
  const pass=document.getElementById('aPass')?.value;
  const{error,data}=await sb.auth.signInWithPassword({email,password:pass});
  if(error){const el=document.getElementById('aErr');if(el){el.textContent=error.message;el.style.display='block';}return;}
  currentUser=data.user;
  await loadData();await handleBoostReturn();setLoggedInNav();nav('events');
}

async function doSignup(){
  const first=document.getElementById('aFirst')?.value.trim();
  const last=document.getElementById('aLast')?.value.trim();
  const email=document.getElementById('aEmail')?.value.trim();
  const pass=document.getElementById('aPass')?.value;
  if(!first||!email||!pass){const el=document.getElementById('aErr');if(el){el.textContent='Please fill in all fields.';el.style.display='block';}return;}
  const{error,data}=await sb.auth.signUp({email,password:pass,options:{data:{full_name:`${first} ${last}`.trim()}}});
  if(error){const el=document.getElementById('aErr');if(el){el.textContent=error.message;el.style.display='block';}return;}
  currentUser=data.user;
  await loadData();setLoggedInNav();nav('dashboard');
  toast('Welcome to CBusEvents! ğŸ‰');
}

// â”€â”€ NAV â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function nav(page){
  currentPage=page;
  document.querySelectorAll('.nav-btn').forEach(el=>el.classList.remove('active'));
  const el=document.getElementById('nav-'+page);
  if(el)el.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
  if(page==='dashboard')renderDashboard();
  else if(page==='venues')renderVenues();
  else if(page==='inquiries')renderInquiries();
  else if(page==='events')renderEvents();
}

// â”€â”€ DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderDashboard(){
  const name=currentUser.user_metadata?.full_name||currentUser.email.split('@')[0];
  const newInq=myInquiries.filter(i=>i.status==='new').length;
  const readInq=myInquiries.filter(i=>i.status==='read').length;

  document.getElementById('app').innerHTML=`
    <div class="page">
      <div style="margin-bottom:28px">
        <h1 style="font-family:'Syne',sans-serif;font-size:26px;font-weight:800;margin-bottom:4px">Welcome back, ${name.split(' ')[0]}! ğŸ‘‹</h1>
        <p style="color:var(--sub);font-size:14px">Here's your event planning dashboard</p>
      </div>

      <div class="stat-row">
        <div class="stat-card">
          <div class="stat-num">${myInquiries.length}</div>
          <div class="stat-label">Total Inquiries Sent</div>
        </div>
        <div class="stat-card">
          <div class="stat-num" style="color:${newInq?'var(--orange)':'var(--text)'}">${newInq}</div>
          <div class="stat-label">Awaiting Response</div>
        </div>
        <div class="stat-card">
          <div class="stat-num">${myEvents.length}</div>
          <div class="stat-label">Events Listed</div>
        </div>
      </div>

      <!-- Quick actions -->
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:28px">
        <div style="background:linear-gradient(135deg,#1a0f00,#250e00);border:1px solid #FF6B3330;border-radius:14px;padding:24px;cursor:pointer" onclick="nav('venues')">
          <div style="font-size:28px;margin-bottom:8px">ğŸ›</div>
          <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:4px">Find a Venue</div>
          <div style="color:var(--sub);font-size:13px">${allVenues.length} venues available in Columbus</div>
        </div>
        <div style="background:linear-gradient(135deg,#0a1a2a,#0a1520);border:1px solid #60a5fa30;border-radius:14px;padding:24px;cursor:pointer" onclick="openAddEventModal()">
          <div style="font-size:28px;margin-bottom:8px">ğŸ“…</div>
          <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:4px">List an Event</div>
          <div style="color:var(--sub);font-size:13px">Publish your event to the Columbus directory</div>
        </div>
      </div>

      <!-- Recent inquiries -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">Recent Inquiries</div>
          <button class="btn btn-ghost btn-sm" onclick="nav('inquiries')">View All â†’</button>
        </div>
        <div class="card-body">
          ${myInquiries.length?myInquiries.slice(0,3).map(i=>inquiryItemHTML(i)).join(''):`
            <div class="empty">
              <div class="empty-icon">ğŸ“¬</div>
              <h3>No inquiries yet</h3>
              <p style="font-size:13px;margin-bottom:16px">Browse venues and send your first booking request</p>
              <button class="btn btn-primary" onclick="nav('venues')">Browse Venues â†’</button>
            </div>`}
        </div>
      </div>

      ${myEvents.length?`
      <div class="card" style="margin-top:16px">
        <div class="card-header">
          <div class="card-title">My Events</div>
          <button class="btn btn-ghost btn-sm" onclick="nav('events')">View All â†’</button>
        </div>
        <div class="card-body">
          ${myEvents.slice(0,3).map(e=>eventItemHTML(e)).join('')}
        </div>
      </div>`:''}
    </div>
  `;
}

// â”€â”€ VENUES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderVenues(){
  document.getElementById('app').innerHTML=`
    <div class="page">
      <div class="section-title">Find a Venue</div>
      <div class="section-sub">${allVenues.length} approved venues in Columbus</div>
      <div class="search-bar">
        <div class="search-wrap">
          <span class="search-icon">ğŸ”</span>
          <input class="search-input" placeholder="Search by name, type, neighborhood..." oninput="filterVenues(this.value)">
        </div>
        <select class="filter-select" onchange="filterVenueType(this.value)">
          <option>All Types</option>
          <option>Bars & Nightlife</option>
          <option>Comedy Clubs</option>
          <option>Rooftop</option>
          <option>Dive Bars</option>
          <option>Theatre & Performance</option>
        </select>
      </div>
      <div class="venue-grid" id="venueGrid">
        ${allVenues.map(v=>venueCardHTML(v,false)).join('')}
      </div>
    </div>
  `;
}

function filterVenues(q){
  const f=allVenues.filter(v=>v.name.toLowerCase().includes(q.toLowerCase())||(v.venue_type||'').toLowerCase().includes(q.toLowerCase())||(v.neighborhood||'').toLowerCase().includes(q.toLowerCase()));
  const el=document.getElementById('venueGrid');
  if(el)el.innerHTML=f.map(v=>venueCardHTML(v,false)).join('')||'<div class="empty"><div class="empty-icon">ğŸ”</div><h3>No venues found</h3></div>';
}

function filterVenueType(type){
  const map={'Bars & Nightlife':['bar','tavern','pub','lounge','speakeasy','cocktail','brewery','rooftop','nightlife'],'Comedy Clubs':['comedy','improv','sketch'],'Rooftop':['rooftop'],'Dive Bars':['dive'],'Theatre & Performance':['theatre','theater','performance']};
  const keys=map[type]||[];
  const f=type==='All Types'?allVenues:allVenues.filter(v=>keys.some(k=>(v.venue_type||'').toLowerCase().includes(k)));
  const el=document.getElementById('venueGrid');
  if(el)el.innerHTML=f.map(v=>venueCardHTML(v,false)).join('')||`<div class="empty"><div class="empty-icon">ğŸ›</div><h3>No ${type} venues yet</h3></div>`;
}

function venueCardHTML(v,preview=false){
  const img=getImg(v);
  return`<div class="venue-card" onclick="${preview?`showAuth('signup')`:`openVenueModal('${v.id}')`}">
    <div class="venue-card-img">
      ${img?`<img src="${img}" alt="${v.name}" onerror="this.parentNode.innerHTML='<div style=width:100%;height:150px;display:flex;align-items:center;justify-content:center;font-size:36px>${venueEmoji(v.venue_type)}</div>'">`:`<div style="font-size:36px">${venueEmoji(v.venue_type)}</div>`}
    </div>
    <div class="venue-card-body">
      <div class="venue-card-type">${v.venue_type||'Venue'}</div>
      <div class="venue-card-name">${v.name}</div>
      <div class="venue-card-desc">${v.description||''}</div>
      <div class="venue-card-footer">
        <span class="venue-card-loc">ğŸ“ ${v.neighborhood||v.city||'Columbus'}</span>
        ${v.capacity?`<span style="font-size:11px;color:var(--muted)">ğŸ‘¥ ${v.capacity}</span>`:''}
      </div>
    </div>
  </div>`;
}

function openVenueModal(id){
  const v=allVenues.find(x=>x.id===id);
  if(!v)return;
  const img=getImg(v);
  document.getElementById('modal').innerHTML=`
    <div class="modal-overlay" onclick="if(event.target===this)closeModal()">
      <div class="modal">
        <div style="position:relative">
          ${img?`<img src="${img}" alt="${v.name}" style="width:100%;height:180px;object-fit:cover" onerror="this.style.display='none'">`:`<div style="height:120px;background:var(--surface);display:flex;align-items:center;justify-content:center;font-size:48px">${venueEmoji(v.venue_type)}</div>`}
          <button onclick="closeModal()" style="position:absolute;top:10px;right:10px;background:rgba(0,0,0,0.6);border:none;color:#fff;border-radius:7px;width:32px;height:32px;font-size:16px;cursor:pointer">âœ•</button>
        </div>
        <div class="modal-body">
          <div style="font-size:11px;color:var(--orange);font-weight:700;text-transform:uppercase;margin-bottom:6px">${v.venue_type||'Venue'}</div>
          <h2 style="font-family:'Syne',sans-serif;font-size:22px;font-weight:800;margin-bottom:14px">${v.name}</h2>
          <div style="display:flex;flex-wrap:wrap;gap:8px;margin-bottom:14px">
            ${v.neighborhood?`<span style="background:var(--surface);border-radius:7px;padding:5px 10px;font-size:12px">ğŸ“ ${v.neighborhood}</span>`:''}
            ${v.capacity?`<span style="background:var(--surface);border-radius:7px;padding:5px 10px;font-size:12px">ğŸ‘¥ Up to ${v.capacity}</span>`:''}
            ${v.phone?`<span style="background:var(--surface);border-radius:7px;padding:5px 10px;font-size:12px">ğŸ“ ${v.phone}</span>`:''}
          </div>
          ${v.description?`<p style="color:var(--sub);font-size:14px;line-height:1.7;margin-bottom:16px">${v.description}</p>`:''}
          ${v.amenities?.length?`<div style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:16px">${v.amenities.map(a=>`<span style="background:var(--surface);border:1px solid var(--border);border-radius:6px;padding:4px 10px;font-size:12px">âœ“ ${a}</span>`).join('')}</div>`:''}
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" onclick="closeModal();openInquiryModal('${v.id}')">Send Booking Inquiry â†’</button>
          <button class="btn btn-ghost" onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>`;
}

// â”€â”€ INQUIRIES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderInquiries(){
  document.getElementById('app').innerHTML=`
    <div class="page">
      <div style="display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:6px">
        <div class="section-title">My Inquiries</div>
        <button class="btn btn-primary btn-sm" onclick="nav('venues')">+ New Inquiry</button>
      </div>
      <div class="section-sub">${myInquiries.length} total inquiries sent</div>
      ${myInquiries.length?myInquiries.map(i=>inquiryItemHTML(i)).join(''):`
        <div class="empty" style="border:1px solid var(--border);border-radius:14px">
          <div class="empty-icon">ğŸ“¬</div>
          <h3>No inquiries yet</h3>
          <p style="font-size:13px;margin-bottom:16px">Find a venue and send your first booking request</p>
          <button class="btn btn-primary" onclick="nav('venues')">Browse Venues â†’</button>
        </div>`}
    </div>`;
}

function inquiryItemHTML(i){
  const statusColor={'new':'badge-orange','read':'badge-blue','replied':'badge-green'};
  return`<div class="inquiry-item" onclick="openInquiryDetail('${i.id}')">
    <div style="flex:1;min-width:0">
      <div class="inq-venue">${i.venues?.name||'Venue'}</div>
      <div class="inq-meta">
        ${i.event_date?`ğŸ“… ${i.event_date} Â· `:''}
        ${i.guest_count?`ğŸ‘¥ ${i.guest_count} guests Â· `:''}
        Sent ${new Date(i.created_at).toLocaleDateString()}
      </div>
      <div style="font-size:12px;color:var(--muted);margin-top:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${i.message||''}</div>
    </div>
    <span class="badge ${statusColor[i.status]||'badge-muted'}">${i.status}</span>
  </div>`;
}

function openInquiryDetail(id){
  const i=myInquiries.find(x=>x.id===id);
  if(!i)return;
  document.getElementById('modal').innerHTML=`
    <div class="modal-overlay" onclick="if(event.target===this)closeModal()">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">Inquiry â€” ${i.venues?.name||'Venue'}</div>
          <button onclick="closeModal()" style="background:none;border:none;color:var(--sub);font-size:18px;cursor:pointer">âœ•</button>
        </div>
        <div class="modal-body">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:16px">
            <div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">VENUE</div><div style="font-weight:600">${i.venues?.name||'â€”'}</div></div>
            <div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">STATUS</div><span class="badge ${i.status==='new'?'badge-orange':i.status==='read'?'badge-blue':'badge-green'}">${i.status}</span></div>
            <div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">EVENT DATE</div><div>${i.event_date||'â€”'}</div></div>
            <div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">GUESTS</div><div>${i.guest_count||'â€”'}</div></div>
            <div><div style="font-size:11px;color:var(--muted);margin-bottom:3px">SENT</div><div>${new Date(i.created_at).toLocaleDateString()}</div></div>
          </div>
          <div><div style="font-size:11px;color:var(--muted);margin-bottom:6px">YOUR MESSAGE</div>
          <div style="background:var(--surface);border:1px solid var(--border);border-radius:8px;padding:14px;font-size:14px;line-height:1.65;color:var(--sub)">${i.message||'â€”'}</div></div>
          <div style="margin-top:14px;padding:14px;background:#0a1a0a;border:1px solid #1a3a1a;border-radius:8px;font-size:13px;color:var(--sub)">
            ğŸ’¡ The venue will reply to <strong style="color:var(--text)">${i.email}</strong> directly via email.
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-ghost" onclick="closeModal()">Close</button>
        </div>
      </div>
    </div>`;
}

// â”€â”€ EVENTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Boost payment links
const BOOST_7=  "https://buy.stripe.com/7sY28t4T930Rd0uc33ew802";
const BOOST_30= "https://buy.stripe.com/8x27sNetJeJz9Oi8QRew803";

function isPromoted(e){
  return e.promoted_until && new Date(e.promoted_until) > new Date();
}
function boostLabel(e){
  if(!isPromoted(e))return'';
  const days=e.boost_tier==='30'?'30-day':'7-day';
  return`<span style="background:#f59e0b20;color:#f59e0b;border:1px solid #f59e0b40;border-radius:20px;padding:2px 9px;font-size:10px;font-weight:700;margin-left:6px">âš¡ BOOSTED ${days}</span>`;
}

function renderEvents(){
  const boosted=myEvents.filter(e=>isPromoted(e));
  document.getElementById('app').innerHTML=`
    <div class="page">
      <div style="display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:6px">
        <div class="section-title">My Events</div>
        <button class="btn btn-primary btn-sm" onclick="openAddEventModal()">+ List an Event</button>
      </div>
      <div class="section-sub">${myEvents.length} events Â· ${boosted.length} currently boosted</div>
      <div style="background:linear-gradient(135deg,#1a1000,#251500);border:1px solid #f59e0b30;border-radius:14px;padding:20px 24px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center;gap:16px;flex-wrap:wrap">
        <div>
          <div style="font-family:'Syne',sans-serif;font-weight:700;font-size:16px;margin-bottom:4px">âš¡ Boost Your Event</div>
          <div style="color:var(--sub);font-size:13px">Pin to top Â· Hero slider Â· Highlighted in categories</div>
        </div>
        <div style="display:flex;gap:8px;flex-shrink:0">
          <div style="background:var(--card);border:1px solid #f59e0b40;border-radius:10px;padding:10px 16px;text-align:center">
            <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:#f59e0b">$10</div>
            <div style="color:var(--muted);font-size:11px">7 days</div>
          </div>
          <div style="background:var(--card);border:1px solid #f59e0b40;border-radius:10px;padding:10px 16px;text-align:center">
            <div style="font-family:'Syne',sans-serif;font-size:18px;font-weight:800;color:#f59e0b">$20</div>
            <div style="color:var(--muted);font-size:11px">30 days</div>
          </div>
        </div>
      </div>
      ${myEvents.length?myEvents.map(e=>eventItemHTML(e)).join(''):`
        <div class="empty" style="border:1px solid var(--border);border-radius:14px">
          <div class="empty-icon">ğŸ“…</div>
          <h3>No events listed yet</h3>
          <p style="font-size:13px;margin-bottom:16px">List your event on CBusEvents to reach Columbus</p>
          <button class="btn btn-primary" onclick="openAddEventModal()">List Your First Event â†’</button>
        </div>`}
    </div>`;
}

function eventItemHTML(e){
  const promoted=isPromoted(e);
  return`<div class="event-item" style="${promoted?'border-color:#f59e0b40;background:linear-gradient(135deg,var(--card),#1a1200)':''}">
    <div style="flex:1;min-width:0">
      <div class="event-title">${e.title}${boostLabel(e)}</div>
      <div class="event-meta">ğŸ“… ${fmt(e.start_time)} Â· ğŸ• ${fmtTime(e.start_time)} Â· ğŸ› ${e.venues?.name||'Columbus'} Â· ${e.category||'Event'}</div>
      ${promoted?`<div style="font-size:11px;color:#f59e0b;margin-top:3px">Boost active until ${new Date(e.promoted_until).toLocaleDateString()}</div>`:''}
    </div>
    <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end;flex-shrink:0">
      <span class="badge ${e.status==='published'?'badge-green':'badge-muted'}">${e.status}</span>
      ${!promoted?`<button class="btn btn-sm" style="background:#f59e0b20;color:#f59e0b;border:1px solid #f59e0b40;white-space:nowrap" onclick="openBoostModal('${e.id}')">âš¡ Boost</button>`:''}
    </div>
  </div>`;
}

function openBoostModal(eventId){
  const e=myEvents.find(x=>x.id===eventId);
  if(!e)return;
  document.getElementById('modal').innerHTML=`
    <div class="modal-overlay" onclick="if(event.target===this)closeModal()">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">âš¡ Boost "${e.title}"</div>
          <button onclick="closeModal()" style="background:none;border:none;color:var(--sub);font-size:18px;cursor:pointer">âœ•</button>
        </div>
        <div class="modal-body">
          <p style="color:var(--sub);font-size:14px;line-height:1.65;margin-bottom:20px">Boosted events get pinned to the top of the events page, featured in the homepage hero slider, and highlighted across category pages.</p>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
            <div style="background:var(--surface);border:1.5px solid #f59e0b40;border-radius:12px;padding:20px;text-align:center;cursor:pointer" onclick="boostCheckout('${eventId}','7')">
              <div style="font-family:'Syne',sans-serif;font-size:28px;font-weight:800;color:#f59e0b">$10</div>
              <div style="font-weight:700;font-size:14px;margin:4px 0">7-Day Boost</div>
              <div style="color:var(--sub);font-size:12px;line-height:1.5">Featured for one week Â· Perfect for upcoming events</div>
              <button class="btn btn-sm" style="margin-top:12px;background:#f59e0b;color:#000;font-weight:700;width:100%">Boost for $10 â†’</button>
            </div>
            <div style="background:var(--surface);border:1.5px solid #f59e0b;border-radius:12px;padding:20px;text-align:center;cursor:pointer;position:relative" onclick="boostCheckout('${eventId}','30')">
              <div style="position:absolute;top:-10px;left:50%;transform:translateX(-50%);background:#f59e0b;color:#000;border-radius:20px;padding:2px 12px;font-size:10px;font-weight:700;white-space:nowrap">BEST VALUE</div>
              <div style="font-family:'Syne',sans-serif;font-size:28px;font-weight:800;color:#f59e0b">$20</div>
              <div style="font-weight:700;font-size:14px;margin:4px 0">30-Day Boost</div>
              <div style="color:var(--sub);font-size:12px;line-height:1.5">Featured all month Â· Max exposure for your event</div>
              <button class="btn btn-sm" style="margin-top:12px;background:#f59e0b;color:#000;font-weight:700;width:100%">Boost for $20 â†’</button>
            </div>
          </div>
        </div>
      </div>
    </div>`;
}

function boostCheckout(eventId, tier){
  const url=tier==='7'?BOOST_7:BOOST_30;
  window.location.href=url+'?client_reference_id=boost_'+eventId+'_'+tier;
}

// â”€â”€ INQUIRY MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openInquiryModal(venueId){
  const v=allVenues.find(x=>x.id===venueId);
  if(!v)return;
  document.getElementById('modal').innerHTML=`
    <div class="modal-overlay" onclick="if(event.target===this)closeModal()">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">Inquiry â€” ${v.name}</div>
          <button onclick="closeModal()" style="background:none;border:none;color:var(--sub);font-size:18px;cursor:pointer">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="field-row">
            <div class="field"><label>Your Name</label><input id="iqName" placeholder="Jane Smith" value="${currentUser.user_metadata?.full_name||''}"></div>
            <div class="field"><label>Phone (optional)</label><input id="iqPhone" placeholder="(614) 555-0000"></div>
          </div>
          <div class="field-row">
            <div class="field"><label>Event Date</label><input id="iqDate" type="date"></div>
            <div class="field"><label>Expected Guests</label><input id="iqGuests" type="number" placeholder="50"></div>
          </div>
          <div class="field"><label>Tell them about your event *</label><textarea id="iqMsg" placeholder="What kind of event are you planning? What do you need from the venue?"></textarea></div>
          <div id="iqErr" style="color:#ef4444;font-size:13px;margin-bottom:8px;display:none"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" onclick="submitInquiry('${venueId}')">Send Inquiry â†’</button>
          <button class="btn btn-ghost" onclick="closeModal()">Cancel</button>
        </div>
      </div>
    </div>`;
}

async function submitInquiry(venueId){
  const name=document.getElementById('iqName')?.value.trim();
  const msg=document.getElementById('iqMsg')?.value.trim();
  const errEl=document.getElementById('iqErr');
  if(!name||!msg){if(errEl){errEl.textContent='Please fill in your name and message.';errEl.style.display='block';}return;}
  const{error}=await sb.from('inquiries').insert({
    venue_id:venueId,name,email:currentUser.email,
    phone:document.getElementById('iqPhone')?.value||null,
    event_date:document.getElementById('iqDate')?.value||null,
    guest_count:document.getElementById('iqGuests')?.value?parseInt(document.getElementById('iqGuests').value):null,
    message:msg,status:'new'
  });
  if(error){if(errEl){errEl.textContent=error.message;errEl.style.display='block';}return;}
  closeModal();
  await loadData();
  toast('âœ“ Inquiry sent! The venue will email you soon.');
  nav('inquiries');
}

// â”€â”€ ADD EVENT MODAL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openAddEventModal(){
  document.getElementById('modal').innerHTML=`
    <div class="modal-overlay" onclick="if(event.target===this)closeModal()">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">List Your Event</div>
          <button onclick="closeModal()" style="background:none;border:none;color:var(--sub);font-size:18px;cursor:pointer">âœ•</button>
        </div>
        <div class="modal-body">
          <div class="field"><label>Event Title *</label><input id="evTitle" placeholder="e.g. Columbus Tech Mixer 2026"></div>
          <div class="field-row">
            <div class="field"><label>Date *</label><input id="evDate" type="date"></div>
            <div class="field"><label>Start Time *</label><input id="evTime" type="time" value="19:00"></div>
          </div>
          <div class="field-row">
            <div class="field"><label>Category</label>
              <select id="evCat">
                <option>Networking</option>
                <option>Comedy</option>
                <option>Concert</option>
                <option>Party</option>
                <option>Corporate</option>
                <option>Festival</option>
                <option>Charity</option>
                <option>Other</option>
              </select>
            </div>
            <div class="field"><label>Venue</label>
              <select id="evVenue">
                <option value="">-- Select a venue --</option>
                ${allVenues.map(v=>`<option value="${v.id}">${v.name}</option>`).join('')}
              </select>
            </div>
          </div>
          <div class="field-row">
            <div class="field"><label>Ticket Price (blank = free)</label><input id="evPrice" type="number" placeholder="0" min="0"></div>
            <div class="field"><label>Ticket URL (optional)</label><input id="evTicket" placeholder="https://..."></div>
          </div>
          <div class="field"><label>Description</label><textarea id="evDesc" placeholder="Tell people what to expect..."></textarea></div>
          <div id="evErr" style="color:#ef4444;font-size:13px;margin-bottom:8px;display:none"></div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary" onclick="submitEvent()">Publish Event â†’</button>
          <button class="btn btn-ghost" onclick="closeModal()">Cancel</button>
        </div>
      </div>
    </div>`;
}

async function submitEvent(){
  const title=document.getElementById('evTitle')?.value.trim();
  const date=document.getElementById('evDate')?.value;
  const time=document.getElementById('evTime')?.value||'19:00';
  const errEl=document.getElementById('evErr');
  if(!title||!date){if(errEl){errEl.textContent='Please fill in event title and date.';errEl.style.display='block';}return;}

  const startTime=new Date(`${date}T${time}:00`);
  const price=document.getElementById('evPrice')?.value;
  const venueId=document.getElementById('evVenue')?.value||null;

  const{error}=await sb.from('events').insert({
    title,
    start_time:startTime.toISOString(),
    category:document.getElementById('evCat')?.value||'Other',
    venue_id:venueId||null,
    description:document.getElementById('evDesc')?.value||null,
    ticket_url:document.getElementById('evTicket')?.value||null,
    price_min:price?parseFloat(price):null,
    is_free:!price||parseFloat(price)===0,
    status:'published',
    planner_email:currentUser.email,
  });
  if(error){if(errEl){errEl.textContent=error.message;errEl.style.display='block';}return;}
  closeModal();
  await loadData();
  toast('âœ“ Event published to CBusEvents!');
  nav('events');
}

// â”€â”€ START â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
init();
</script>
</body>
</html>
